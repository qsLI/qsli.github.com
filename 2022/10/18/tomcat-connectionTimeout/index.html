<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="python | C++ | C plus plus | java"><title>tomcat配置connectionTimeout | KL's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body> <div id="particles-js"></div><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">tomcat配置connectionTimeout</h1><a id="logo" href="/.">KL's blog</a><p class="description">世事洞明皆学问，人情练达即文章</p></div><div id="nav-menu"><a href="/"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/recommendation/"><i class="fa fa-leaf"> 推荐</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">tomcat配置connectionTimeout</h1><div class="post-meta">Oct 18, 2022<span> | </span><span class="category"><a href="/categories/tomcat/">tomcat</a></span><script type="text/javascript" src="/js/busuanzi.pure.mini.js?v=0.0.0" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2022/10/18/tomcat-connectionTimeout/" href="/2022/10/18/tomcat-connectionTimeout/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#验证"><span class="toc-number">1.</span> <span class="toc-text">验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#telnet"><span class="toc-number">1.1.</span> <span class="toc-text">telnet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#arthas"><span class="toc-number">1.2.</span> <span class="toc-text">arthas</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码"><span class="toc-number">2.</span> <span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">3.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">4.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="post-content"><blockquote>
<p>The number of milliseconds this <strong>Connector</strong> will wait, after accepting a connection, for the request URI line to be presented. Use a value of -1 to indicate no (i.e. infinite) timeout. The default value is 60000 (i.e. 60 seconds) but note that the standard server.xml that ships with Tomcat sets this to 20000 (i.e. 20 seconds). Unless <strong>disableUploadTimeout</strong> is set to <code>false</code>, this timeout will also be used when reading the request body (if any).</p>
</blockquote>
<p>从连接被accept之后，到request line出现的超时时间，单位是毫秒。</p>
<h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><p>使用telnet连接上tomcat的端口，然后不发送请求，等待超时。得到如下结果，耗时大概20s左右。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  qsli.github.com (hexo|✚23…) time telnet localhost 8087</span><br><span class="line">Trying ::1...</span><br><span class="line">Connected to localhost.</span><br><span class="line">Escape character is <span class="string">'^]'</span>.</span><br><span class="line">Connection closed by foreign host.</span><br><span class="line">telnet localhost 8087  0.01s user 0.01s system 0% cpu 20.064 total</span><br></pre></td></tr></table></figure>
<h3 id="arthas"><a href="#arthas" class="headerlink" title="arthas"></a>arthas</h3><p>使用arthas查看mbean，找到超时的配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">[arthas@77045]$ mbean Catalina:<span class="built_in">type</span>=Connector,port=8087</span><br><span class="line"> OBJECT_NAME               Catalina:<span class="built_in">type</span>=Connector,port=8087</span><br><span class="line">------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> NAME                      VALUE</span><br><span class="line">------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> modelerType               null</span><br><span class="line"> maxPostSize               2097152</span><br><span class="line"> proxyName                 null</span><br><span class="line"> scheme                    http</span><br><span class="line"> className                 null</span><br><span class="line"> acceptCount               100</span><br><span class="line"> secret                    Unavailable</span><br><span class="line"> secure                    <span class="literal">false</span></span><br><span class="line"> threadPriority            -1</span><br><span class="line"> maxSwallowSize            2097152</span><br><span class="line"> ajpFlush                  null</span><br><span class="line"> maxSavePostSize           4096</span><br><span class="line"> proxyPort                 0</span><br><span class="line"> sslProtocols              null</span><br><span class="line"> protocol                  HTTP/1.1</span><br><span class="line"> maxParameterCount         10000</span><br><span class="line"> useIPVHosts               <span class="literal">false</span></span><br><span class="line"> stateName                 STARTED</span><br><span class="line"> redirectPort              8443</span><br><span class="line"> allowTrace                <span class="literal">false</span></span><br><span class="line"> ciphers                   HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!kRSA</span><br><span class="line"> protocolHandlerClassName  org.apache.coyote.http11.Http11NioProtocol</span><br><span class="line"> maxThreads                -1</span><br><span class="line"> connectionTimeout         20000</span><br><span class="line"> tcpNoDelay                <span class="literal">true</span></span><br><span class="line"> useBodyEncodingForURI     <span class="literal">false</span></span><br><span class="line"> connectionLinger          -1</span><br><span class="line"> processorCache            200</span><br><span class="line"> keepAliveTimeout          20000</span><br><span class="line"> maxKeepAliveRequests      100</span><br><span class="line"> address                   null</span><br><span class="line"> localPort                 8087</span><br><span class="line"> enableLookups             <span class="literal">false</span></span><br><span class="line"> packetSize                null</span><br><span class="line"> URIEncoding               UTF-8</span><br><span class="line"> minSpareThreads           -1</span><br><span class="line"> executorName              tomcatThreadPool</span><br><span class="line"> ciphersUsed               null</span><br><span class="line"> maxHeaderCount            100</span><br><span class="line"> port                      8087</span><br><span class="line"> xpoweredBy                <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>connectionTimeout         20000</p>
</blockquote>
<p>配置的是20s</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>实际是socket timeout</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.apache.coyote.AbstractProtocol#getConnectionTimeout</span></span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * When Tomcat expects data from the client, this is the time Tomcat will</span></span><br><span class="line"><span class="comment">     * wait for that data to arrive before closing the connection.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getConnectionTimeout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Note that the endpoint uses the alternative name</span></span><br><span class="line">  <span class="keyword">return</span> endpoint.getSoTimeout();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConnectionTimeout</span><span class="params">(<span class="keyword">int</span> timeout)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Note that the endpoint uses the alternative name</span></span><br><span class="line">  endpoint.setSoTimeout(timeout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// org.apache.tomcat.util.net.AbstractEndpoint#setSoTimeout</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSoTimeout</span><span class="params">(<span class="keyword">int</span> soTimeout)</span> </span>&#123; socketProperties.setSoTimeout(soTimeout); &#125;</span><br></pre></td></tr></table></figure>
<p>使用的地方，设置在了NioSocketWrapper的ReadTimeout和WriteTimeout上：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//org.apache.tomcat.util.net.NioEndpoint.Poller#register</span></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * Registers a newly created socket with the poller.</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> socket    The newly created socket</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(<span class="keyword">final</span> NioChannel socket)</span> </span>&#123;</span><br><span class="line">  socket.setPoller(<span class="keyword">this</span>);</span><br><span class="line">  NioSocketWrapper ka = <span class="keyword">new</span> NioSocketWrapper(socket, NioEndpoint.<span class="keyword">this</span>);</span><br><span class="line">  socket.setSocketWrapper(ka);</span><br><span class="line">  ka.setPoller(<span class="keyword">this</span>);</span><br><span class="line">  <span class="comment">// 这里，read/write timeout</span></span><br><span class="line">  ka.setReadTimeout(getSocketProperties().getSoTimeout());</span><br><span class="line">  ka.setWriteTimeout(getSocketProperties().getSoTimeout());</span><br><span class="line">  ka.setKeepAliveLeft(NioEndpoint.<span class="keyword">this</span>.getMaxKeepAliveRequests());</span><br><span class="line">  ka.setSecure(isSSLEnabled());</span><br><span class="line">  ka.setReadTimeout(getSoTimeout());</span><br><span class="line">  ka.setWriteTimeout(getSoTimeout());</span><br><span class="line">  PollerEvent r = eventCache.pop();</span><br><span class="line">  ka.interestOps(SelectionKey.OP_READ);<span class="comment">//this is what OP_REGISTER turns into.</span></span><br><span class="line">  <span class="keyword">if</span> ( r==<span class="keyword">null</span>) r = <span class="keyword">new</span> PollerEvent(socket,ka,OP_REGISTER);</span><br><span class="line">  <span class="keyword">else</span> r.reset(socket,ka,OP_REGISTER);</span><br><span class="line">  addEvent(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Poller线程中会check这个key是否过期，并不是每次都check，而是有一定的策略：</p>
<blockquote>
<p> However, do process timeouts if any of the following are true:</p>
<ul>
<li>the <strong>selector</strong> simply <strong>timed out</strong> (suggests there isn’t much load)</li>
<li>the <strong>nextExpiration</strong> time has <strong>passed</strong></li>
<li>the server <strong>socket</strong> is <strong>being closed</strong></li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.apache.tomcat.util.net.NioEndpoint.Poller#timeout</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">timeout</span><span class="params">(<span class="keyword">int</span> keyCount, <span class="keyword">boolean</span> hasEvents)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">  <span class="comment">// This method is called on every loop of the Poller. Don't process</span></span><br><span class="line">  <span class="comment">// timeouts on every loop of the Poller since that would create too</span></span><br><span class="line">  <span class="comment">// much load and timeouts can afford to wait a few seconds.</span></span><br><span class="line">  <span class="comment">// However, do process timeouts if any of the following are true:</span></span><br><span class="line">  <span class="comment">// - the selector simply timed out (suggests there isn't much load)</span></span><br><span class="line">  <span class="comment">// - the nextExpiration time has passed</span></span><br><span class="line">  <span class="comment">// - the server socket is being closed</span></span><br><span class="line">  <span class="keyword">if</span> (nextExpiration &gt; <span class="number">0</span> &amp;&amp; (keyCount &gt; <span class="number">0</span> || hasEvents) &amp;&amp; (now &lt; nextExpiration) &amp;&amp; !close) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//timeout</span></span><br><span class="line">  <span class="keyword">int</span> keycount = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (SelectionKey key : selector.keys()) &#123;</span><br><span class="line">      keycount++;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        NioSocketWrapper ka = (NioSocketWrapper) key.attachment();</span><br><span class="line">        <span class="keyword">if</span> ( ka == <span class="keyword">null</span> ) &#123;</span><br><span class="line">          cancelledKey(key); <span class="comment">//we don't support any keys without attachments</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (close) &#123;</span><br><span class="line">          key.interestOps(<span class="number">0</span>);</span><br><span class="line">          ka.interestOps(<span class="number">0</span>); <span class="comment">//avoid duplicate stop calls</span></span><br><span class="line">          processKey(key,ka);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((ka.interestOps()&amp;SelectionKey.OP_READ) == SelectionKey.OP_READ ||</span><br><span class="line">                   (ka.interestOps()&amp;SelectionKey.OP_WRITE) == SelectionKey.OP_WRITE) &#123;</span><br><span class="line">          <span class="keyword">boolean</span> isTimedOut = <span class="keyword">false</span>;</span><br><span class="line">          <span class="comment">// Check for read timeout</span></span><br><span class="line">          <span class="comment">// 读超时</span></span><br><span class="line">          <span class="keyword">if</span> ((ka.interestOps() &amp; SelectionKey.OP_READ) == SelectionKey.OP_READ) &#123;</span><br><span class="line">            <span class="keyword">long</span> delta = now - ka.getLastRead();</span><br><span class="line">            <span class="keyword">long</span> timeout = ka.getReadTimeout();</span><br><span class="line">            isTimedOut = timeout &gt; <span class="number">0</span> &amp;&amp; delta &gt; timeout;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// Check for write timeout</span></span><br><span class="line">          <span class="comment">// 写超时</span></span><br><span class="line">          <span class="keyword">if</span> (!isTimedOut &amp;&amp; (ka.interestOps() &amp; SelectionKey.OP_WRITE) == SelectionKey.OP_WRITE) &#123;</span><br><span class="line">            <span class="keyword">long</span> delta = now - ka.getLastWrite();</span><br><span class="line">            <span class="keyword">long</span> timeout = ka.getWriteTimeout();</span><br><span class="line">            isTimedOut = timeout &gt; <span class="number">0</span> &amp;&amp; delta &gt; timeout;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 超时之后处理</span></span><br><span class="line">          <span class="keyword">if</span> (isTimedOut) &#123;</span><br><span class="line">            key.interestOps(<span class="number">0</span>);</span><br><span class="line">            ka.interestOps(<span class="number">0</span>); <span class="comment">//avoid duplicate timeout calls</span></span><br><span class="line">            ka.setError(<span class="keyword">new</span> SocketTimeoutException());</span><br><span class="line">            <span class="comment">// 注意这里是SocketEvent.ERROR</span></span><br><span class="line">            <span class="keyword">if</span> (!processSocket(ka, SocketEvent.ERROR, <span class="keyword">true</span>)) &#123;</span><br><span class="line">              cancelledKey(key);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">catch</span> ( CancelledKeyException ckx ) &#123;</span><br><span class="line">        cancelledKey(key);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="comment">//for</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (ConcurrentModificationException cme) &#123;</span><br><span class="line">    <span class="comment">// See https://bz.apache.org/bugzilla/show_bug.cgi?id=57943</span></span><br><span class="line">    log.warn(sm.getString(<span class="string">"endpoint.nio.timeoutCme"</span>), cme);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">long</span> prevExp = nextExpiration; <span class="comment">//for logging purposes only</span></span><br><span class="line">  nextExpiration = System.currentTimeMillis() +</span><br><span class="line">    socketProperties.getTimeoutInterval();</span><br><span class="line">  <span class="keyword">if</span> (log.isTraceEnabled()) &#123;</span><br><span class="line">    log.trace(<span class="string">"timeout completed: keys processed="</span> + keycount +</span><br><span class="line">              <span class="string">"; now="</span> + now + <span class="string">"; nextExpiration="</span> + prevExp +</span><br><span class="line">              <span class="string">"; keyCount="</span> + keyCount + <span class="string">"; hasEvents="</span> + hasEvents +</span><br><span class="line">              <span class="string">"; eval="</span> + ((now &lt; prevExp) &amp;&amp; (keyCount&gt;<span class="number">0</span> || hasEvents) &amp;&amp; (!close) ));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用arthas观察下超时时服务端的处理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">`---ts=2022-10-18 23:38:39;thread_name=http-nio-8087-ClientPoller-0;id=1c;is_daemon=<span class="literal">true</span>;priority=5;TCCL=java.net.URLClassLoader@470e2030</span><br><span class="line">    `---[0.269583ms] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$Poller</span>:timeout()</span><br><span class="line">        +---[2.06% 0.005542ms ] java.lang.System:currentTimeMillis() <span class="comment">#1004</span></span><br><span class="line">        +---[0.97% 0.002625ms ] java.nio.channels.Selector:keys() <span class="comment">#1018</span></span><br><span class="line">        +---[1.27% 0.003417ms ] java.util.Set:iterator() <span class="comment">#1018</span></span><br><span class="line">        +---[1.64% min=0.00175ms,max=0.002666ms,total=0.004416ms,count=2] java.util.Iterator:hasNext() <span class="comment">#1018</span></span><br><span class="line">        +---[1.04% 0.002791ms ] java.util.Iterator:next() <span class="comment">#1018</span></span><br><span class="line">        +---[0.91% 0.002458ms ] java.nio.channels.SelectionKey:attachment() <span class="comment">#1021</span></span><br><span class="line">        +---[0.99% 0.002666ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$NioSocketWrapper</span>:interestOps() <span class="comment">#1028</span></span><br><span class="line">        +---[0.60% 0.001625ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$NioSocketWrapper</span>:interestOps() <span class="comment">#1032</span></span><br><span class="line">        +---[0.74% 0.002ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$NioSocketWrapper</span>:getLastRead() <span class="comment">#1033</span></span><br><span class="line">        +---[0.85% 0.002291ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$NioSocketWrapper</span>:getReadTimeout() <span class="comment">#1034</span></span><br><span class="line">        +---[18.01% 0.048541ms ] java.nio.channels.SelectionKey:interestOps() <span class="comment">#1044</span></span><br><span class="line">        +---[2.74% 0.007375ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$NioSocketWrapper</span>:interestOps() <span class="comment">#1045</span></span><br><span class="line">        +---[7.31% 0.019708ms ] java.net.SocketTimeoutException:&lt;init&gt;() <span class="comment">#1046</span></span><br><span class="line">        +---[3.38% 0.009125ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$NioSocketWrapper</span>:setError() <span class="comment">#1046</span></span><br><span class="line">        +---[19.18% 0.051709ms ] org.apache.tomcat.util.net.NioEndpoint:processSocket() <span class="comment">#1047</span></span><br><span class="line">        +---[0.79% 0.002125ms ] java.lang.System:currentTimeMillis() <span class="comment">#1061</span></span><br><span class="line">        +---[0.88% 0.002375ms ] org.apache.tomcat.util.net.SocketProperties:getTimeoutInterval() <span class="comment">#1061</span></span><br><span class="line">        +---[0.88% 0.002375ms ] org.apache.tomcat.util.net.NioEndpoint:access<span class="variable">$100</span>() <span class="comment">#1063</span></span><br><span class="line">        `---[1.19% 0.003208ms ] org.apache.juli.logging.Log:isTraceEnabled() <span class="comment">#1063</span></span><br></pre></td></tr></table></figure>
<p>超时之后，new了一个SocketTimeoutException，交给processSocket进行处理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[arthas@22174]$ trace org.apache.tomcat.util.net.AbstractEndpoint processSocket -v -n 5 --skipJDKMethod <span class="literal">false</span> <span class="string">'1==1'</span></span><br><span class="line">Press Q or Ctrl+C to abort.</span><br><span class="line">Affect(class count: 3 , method count: 1) cost <span class="keyword">in</span> 123 ms, listenerId: 4</span><br><span class="line">Condition express: 1==1 , result: <span class="literal">true</span></span><br><span class="line">`---ts=2022-10-18 23:41:44;thread_name=http-nio-8087-ClientPoller-1;id=1d;is_daemon=<span class="literal">true</span>;priority=5;TCCL=java.net.URLClassLoader@470e2030</span><br><span class="line">    `---[0.355583ms] org.apache.tomcat.util.net.AbstractEndpoint:processSocket()</span><br><span class="line">        +---[5.44% 0.019334ms ] org.apache.tomcat.util.collections.SynchronizedStack:pop() <span class="comment">#1040</span></span><br><span class="line">        +---[8.26% 0.029375ms ] org.apache.tomcat.util.net.SocketProcessorBase:reset() <span class="comment">#1044</span></span><br><span class="line">        +---[4.59% 0.016333ms ] org.apache.tomcat.util.net.AbstractEndpoint:getExecutor() <span class="comment">#1046</span></span><br><span class="line">        `---[25.59% 0.091ms ] java.util.concurrent.Executor:execute() <span class="comment">#1048</span></span><br></pre></td></tr></table></figure>
<p>接着跟进，看看是哪里退出的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[arthas@22174]$ trace org.apache.tomcat.util.net.NioEndpoint<span class="variable">$SocketProcessor</span> doRun -v -n 5 --skipJDKMethod <span class="literal">false</span> <span class="string">'1==1'</span></span><br><span class="line">Press Q or Ctrl+C to abort.</span><br><span class="line">Affect(class count: 1 , method count: 1) cost <span class="keyword">in</span> 140 ms, listenerId: 5</span><br><span class="line">Condition express: 1==1 , result: <span class="literal">true</span></span><br><span class="line">`---ts=2022-10-18 23:44:40;thread_name=catalina-exec-2;id=1a;is_daemon=<span class="literal">true</span>;priority=5;TCCL=java.net.URLClassLoader@470e2030</span><br><span class="line">    `---[1.595584ms] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$SocketProcessor</span>:doRun()</span><br><span class="line">        +---[1.79% 0.028584ms ] org.apache.tomcat.util.net.SocketWrapperBase:getSocket() <span class="comment">#1430</span></span><br><span class="line">        +---[1.14% 0.018125ms ] org.apache.tomcat.util.net.NioChannel:getIOChannel() <span class="comment">#1431</span></span><br><span class="line">        +---[1.92% 0.030625ms ] org.apache.tomcat.util.net.NioChannel:getPoller() <span class="comment">#1431</span></span><br><span class="line">        +---[1.19% 0.018916ms ] org.apache.tomcat.util.net.NioEndpoint<span class="variable">$Poller</span>:getSelector() <span class="comment">#1431</span></span><br><span class="line">        +---[30.62% 0.488542ms ] java.nio.channels.SocketChannel:keyFor() <span class="comment">#1431</span></span><br><span class="line">        +---[0.91% 0.0145ms ] org.apache.tomcat.util.net.NioChannel:isHandshakeComplete() <span class="comment">#1438</span></span><br><span class="line">        +---[1.07% 0.017ms ] org.apache.tomcat.util.net.NioEndpoint:getHandler() <span class="comment">#1471</span></span><br><span class="line">        +---[2.11% 0.033708ms ] org.apache.tomcat.util.net.AbstractEndpoint<span class="variable">$Handler</span>:process() <span class="comment">#1471</span></span><br><span class="line">        +---[24.60% 0.3925ms ] org.apache.tomcat.util.net.NioEndpoint:access<span class="variable">$500</span>() <span class="comment">#1474</span></span><br><span class="line">        `---[1.11% 0.017667ms ] org.apache.tomcat.util.collections.SynchronizedStack:push() <span class="comment">#1495</span></span><br><span class="line">        </span><br><span class="line">[arthas@22174]$ trace org.apache.coyote.AbstractProtocol<span class="variable">$ConnectionHandler</span> process -v -n 5 --skipJDKMethod <span class="literal">false</span> <span class="string">'1==1'</span></span><br><span class="line">Press Q or Ctrl+C to abort.</span><br><span class="line">Affect(class count: 1 , method count: 1) cost <span class="keyword">in</span> 659 ms, listenerId: 7</span><br><span class="line">Condition express: 1==1 , result: <span class="literal">true</span></span><br><span class="line">`---ts=2022-10-18 23:49:21;thread_name=catalina-exec-2;id=1a;is_daemon=<span class="literal">true</span>;priority=5;TCCL=java.net.URLClassLoader@470e2030</span><br><span class="line">    `---[0.475083ms] org.apache.coyote.AbstractProtocol<span class="variable">$ConnectionHandler</span>:process()</span><br><span class="line">        +---[22.07% 0.104833ms ] org.apache.coyote.AbstractProtocol<span class="variable">$ConnectionHandler</span>:getLog() <span class="comment">#705</span></span><br><span class="line">        +---[5.65% 0.026833ms ] org.apache.juli.logging.Log:isDebugEnabled() <span class="comment">#705</span></span><br><span class="line">        +---[2.91% 0.013834ms ] org.apache.tomcat.util.net.SocketWrapperBase:getSocket() <span class="comment">#714</span></span><br><span class="line">        +---[3.99% 0.018959ms ] java.util.Map:get() <span class="comment">#716</span></span><br><span class="line">        +---[1.16% 0.0055ms ] org.apache.coyote.AbstractProtocol<span class="variable">$ConnectionHandler</span>:getLog() <span class="comment">#717</span></span><br><span class="line">        `---[0.84% 0.004ms ] org.apache.juli.logging.Log:isDebugEnabled() <span class="comment">#717</span></span><br></pre></td></tr></table></figure>
<p>由于传入的是SocketEvent.ERROR，在ConnectionHandler中就直接返回了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.apache.coyote.AbstractProtocol.ConnectionHandler#process</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SocketState <span class="title">process</span><span class="params">(SocketWrapperBase&lt;S&gt; wrapper, SocketEvent status)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (getLog().isDebugEnabled()) &#123;</span><br><span class="line">    getLog().debug(sm.getString(<span class="string">"abstractConnectionHandler.process"</span>,</span><br><span class="line">                                wrapper.getSocket(), status));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (wrapper == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">// Nothing to do. Socket has been closed.</span></span><br><span class="line">    <span class="keyword">return</span> SocketState.CLOSED;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  S socket = wrapper.getSocket();</span><br><span class="line"></span><br><span class="line">  Processor processor = connections.get(socket);</span><br><span class="line">  <span class="keyword">if</span> (processor != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">// Make sure an async timeout doesn't fire</span></span><br><span class="line">    getProtocol().removeWaitingProcessor(processor);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status == SocketEvent.DISCONNECT || status == SocketEvent.ERROR) &#123;</span><br><span class="line">    <span class="comment">// Nothing to do. Endpoint requested a close and there is no</span></span><br><span class="line">    <span class="comment">// longer a processor associated with this socket.</span></span><br><span class="line">    <span class="comment">// 走到这里了，最终决定将连接关闭</span></span><br><span class="line">    <span class="keyword">return</span> SocketState.CLOSED;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>connectionTimeout文档上说是连接accept之后，等待requestLine的超时时间，单位毫秒</li>
<li>从NIO的代码来看，被当做了read、write的超时</li>
<li>Poller线程在并不是每次都check超时，而是有一定的策略。在保证超时的语义下，尽量在load低的时候操作。</li>
<li>退出流程： <ul>
<li>Poller#timeout</li>
<li>NioEndpoint$SocketProcessor#run [<strong>SocketEvent.ERROR</strong>]</li>
<li>AbstractEndpoint$Handler#process [<strong>SocketState.CLOSED</strong>] </li>
</ul>
</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://tomcat.apache.org/tomcat-8.5-doc/config/http.html" rel="external nofollow noopener noreferrer" target="_blank">Apache Tomcat 8 Configuration Reference (8.5.83) - The HTTP Connector</a></li>
</ul>
</div><footer class="post-footer"><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者: </strong>代故</li><li class="post-copyright-link"><strong>本文链接: </strong>    <a href="/2022/10/18/tomcat-connectionTimeout/" target="_blank">http://qsli.github.io/2022/10/18/tomcat-connectionTimeout/index.html</a></li>  <li class="post-copyright-license"><strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 3.0 CN</a></li></ul></div></footer><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://qsli.github.io/2022/10/18/tomcat-connectionTimeout/" data-id="cl9frej2t00euav6nj9qt9i66" class="article-share-link">分享到</a><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" href="javascript:;" title="打赏" class="btn_donate"></a><div class="donate_txt"> &uarr;<br>此文有用? 整杯冰阔乐!<br></div></div><div id="donate_guide" class="donate_bar center hidden"><img src="http://qsli.github.io/about/praise.jpg" title="微信打赏"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    $('#donate_board').addClass('hidden');
    $('#donate_guide').removeClass('hidden');
}</script></div><div class="tags"><a href="/tags/tomcat/">tomcat</a></div><div class="post-nav"><a href="/2022/10/19/tomcat-startup-3/" class="pre">tomcat bind/listen/acceptor过程</a><a href="/2022/10/06/tomcat-threadpool-timeout/" class="next">tomcat的线程池为什么不回落？</a></div><div id="disqus_thread"><script>var disqus_shortname = 'blog-huytwsybye';
var disqus_identifier = '2022/10/18/tomcat-connectionTimeout/';
var disqus_title = 'tomcat配置connectionTimeout';
var disqus_url = 'http://qsli.github.io/2022/10/18/tomcat-connectionTimeout/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//blog-huytwsybye.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://qsli.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/base/">base</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/db/">db</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/druid/">druid</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/dubbo/">dubbo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/fe/">fe</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/feign/">feign</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/guava/">guava</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/idea/">idea</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/jdbc/">jdbc</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/jvm/">jvm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mediawiki/">mediawiki</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/microservice/">microservice</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mybatis/">mybatis</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/perf/">perf</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tomcat/">tomcat</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/xml/" style="font-size: 15px;">xml</a> <a href="/tags/jackson/" style="font-size: 15px;">jackson</a> <a href="/tags/logback/" style="font-size: 15px;">logback</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/threadpool/" style="font-size: 15px;">threadpool</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/剪贴板/" style="font-size: 15px;">剪贴板</a> <a href="/tags/mat/" style="font-size: 15px;">mat</a> <a href="/tags/guava/" style="font-size: 15px;">guava</a> <a href="/tags/编码/" style="font-size: 15px;">编码</a> <a href="/tags/cache/" style="font-size: 15px;">cache</a> <a href="/tags/cglib/" style="font-size: 15px;">cglib</a> <a href="/tags/crontab/" style="font-size: 15px;">crontab</a> <a href="/tags/自定义标签/" style="font-size: 15px;">自定义标签</a> <a href="/tags/cygwin/" style="font-size: 15px;">cygwin</a> <a href="/tags/pitfall-mysql-connector-java-8-x/" style="font-size: 15px;">pitfall mysql-connector-java 8.x</a> <a href="/tags/fabric/" style="font-size: 15px;">fabric</a> <a href="/tags/electron/" style="font-size: 15px;">electron</a> <a href="/tags/beanfactory/" style="font-size: 15px;">beanfactory</a> <a href="/tags/spring-cloud/" style="font-size: 15px;">spring-cloud</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/git-commit-id/" style="font-size: 15px;">git-commit-id</a> <a href="/tags/go学习资料/" style="font-size: 15px;">go学习资料</a> <a href="/tags/grafana/" style="font-size: 15px;">grafana</a> <a href="/tags/hexo-install/" style="font-size: 15px;">hexo install</a> <a href="/tags/lsof/" style="font-size: 15px;">lsof</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/tranfer-encoding/" style="font-size: 15px;">tranfer-encoding</a> <a href="/tags/template/" style="font-size: 15px;">template</a> <a href="/tags/jar/" style="font-size: 15px;">jar</a> <a href="/tags/exception/" style="font-size: 15px;">exception</a> <a href="/tags/访问权限/" style="font-size: 15px;">访问权限</a> <a href="/tags/Javadoc/" style="font-size: 15px;">Javadoc</a> <a href="/tags/java-connector/" style="font-size: 15px;">java-connector</a> <a href="/tags/jinfo/" style="font-size: 15px;">jinfo</a> <a href="/tags/ajax/" style="font-size: 15px;">ajax</a> <a href="/tags/markdown-here/" style="font-size: 15px;">markdown-here</a> <a href="/tags/mindmap/" style="font-size: 15px;">mindmap</a> <a href="/tags/plantuml/" style="font-size: 15px;">plantuml</a> <a href="/tags/自增主键/" style="font-size: 15px;">自增主键</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/netcat/" style="font-size: 15px;">netcat</a> <a href="/tags/pip/" style="font-size: 15px;">pip</a> <a href="/tags/uml/" style="font-size: 15px;">uml</a> <a href="/tags/postgresql/" style="font-size: 15px;">postgresql</a> <a href="/tags/python-util/" style="font-size: 15px;">python-util</a> <a href="/tags/re/" style="font-size: 15px;">re</a> <a href="/tags/shadowsocks/" style="font-size: 15px;">shadowsocks</a> <a href="/tags/limit/" style="font-size: 15px;">limit</a> <a href="/tags/spi/" style="font-size: 15px;">spi</a> <a href="/tags/spring-mvc/" style="font-size: 15px;">spring mvc</a> <a href="/tags/sqlserver-killer/" style="font-size: 15px;">sqlserver-killer</a> <a href="/tags/sudo-log/" style="font-size: 15px;">sudo-log</a> <a href="/tags/access-log/" style="font-size: 15px;">access-log</a> <a href="/tags/busy-thread/" style="font-size: 15px;">busy-thread</a> <a href="/tags/swap/" style="font-size: 15px;">swap</a> <a href="/tags/connections/" style="font-size: 15px;">connections</a> <a href="/tags/encoding/" style="font-size: 15px;">encoding</a> <a href="/tags/string-manager/" style="font-size: 15px;">string-manager</a> <a href="/tags/feign/" style="font-size: 15px;">feign</a> <a href="/tags/servlet/" style="font-size: 15px;">servlet</a> <a href="/tags/format/" style="font-size: 15px;">format</a> <a href="/tags/druid/" style="font-size: 15px;">druid</a> <a href="/tags/generic/" style="font-size: 15px;">generic</a> <a href="/tags/executor/" style="font-size: 15px;">executor</a> <a href="/tags/greys/" style="font-size: 15px;">greys</a> <a href="/tags/event-bus/" style="font-size: 15px;">event-bus</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/executeBatch/" style="font-size: 15px;">executeBatch</a> <a href="/tags/HttpURLConnection/" style="font-size: 15px;">HttpURLConnection</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/mybatis/" style="font-size: 15px;">mybatis</a> <a href="/tags/tracing/" style="font-size: 15px;">tracing</a> <a href="/tags/reference/" style="font-size: 15px;">reference</a> <a href="/tags/resource/" style="font-size: 15px;">resource</a> <a href="/tags/sudo/" style="font-size: 15px;">sudo</a> <a href="/tags/top/" style="font-size: 15px;">top</a> <a href="/tags/volatile/" style="font-size: 15px;">volatile</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/messageConverter/" style="font-size: 15px;">messageConverter</a> <a href="/tags/google-perf/" style="font-size: 15px;">google-perf</a> <a href="/tags/jdwp/" style="font-size: 15px;">jdwp</a> <a href="/tags/keepalive/" style="font-size: 15px;">keepalive</a> <a href="/tags/spring-bean/" style="font-size: 15px;">spring-bean</a> <a href="/tags/tomcat-startup/" style="font-size: 15px;">tomcat-startup</a> <a href="/tags/cache-prep-stmts/" style="font-size: 15px;">cache-prep-stmts</a> <a href="/tags/placeholder/" style="font-size: 15px;">placeholder</a> <a href="/tags/tcp/" style="font-size: 15px;">tcp</a> <a href="/tags/transaction/" style="font-size: 15px;">transaction</a> <a href="/tags/spring-validator/" style="font-size: 15px;">spring-validator</a> <a href="/tags/spring-aop/" style="font-size: 15px;">spring-aop</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/10/19/tomcat-startup-3/">tomcat bind/listen/acceptor过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/18/tomcat-connectionTimeout/">tomcat配置connectionTimeout</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/06/tomcat-threadpool-timeout/">tomcat的线程池为什么不回落？</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/05/tomcat-when-queue-is-full/">tomcat队列满了之后会发生什么？</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/07/tomcat-stringcache/">tomcat-stringcache</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/07/reflection/">Java的反射慢吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/08/open-tracing/">open-tracing</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/05/tomcat-startup-2/">tomcat-startup-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/27/tomcat-component-lifecycle/">tomcat-component-lifecycle</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/20/tomcat-startup/">tomcat-startup</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//blog-huytwsybye.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://iip.whu.edu.cn/" title="武汉大学智能信息处理实验室" target="_blank" rel="external nofollow noopener noreferrer">武汉大学智能信息处理实验室</a><ul></ul><a href="http://calvin1978.blogcn.com/" title="江南白衣" target="_blank" rel="external nofollow noopener noreferrer">江南白衣</a><ul></ul><a href="https://chenyuzuoo.github.io/" title="Chenyu's Script" target="_blank" rel="external nofollow noopener noreferrer">Chenyu's Script</a><ul></ul><a href="https://zhangpengdeshu.github.io/" title="前端小胖儿" target="_blank" rel="external nofollow noopener noreferrer">前端小胖儿</a><ul></ul><a href="http://huzongzhe.cn/" title="胡大腿" target="_blank" rel="external nofollow noopener noreferrer">胡大腿</a></div><div class="widget"><div class="widget-title"><i class="fa fa-eye"> 本站访问量</i></div><div><script type="text/javascript" src="/js/busuanzi.pure.mini.js?v=0.0.0" async="async"></script><p> 访问量:<span id="busuanzi_value_site_pv"> </span></p><p> 访客数:<span id="busuanzi_value_site_uv"></span></p></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer"><p><a href="/." rel="nofollow">KL's blog </a><span>© 2015 - 2022.</span></p><p> Powered by<a rel="external nofollow noopener noreferrer" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="external nofollow noopener noreferrer" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="external nofollow noopener noreferrer" target="_blank" href="https://github.com/pagecho"> Cho.</a></p></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="/js/kity.min.js?v=0.0.0" sync></script><script type="text/javascript" src="/js/kityminder.core.js?v=0.0.0" sync></script><script type="text/javascript" src="/js/mindmap.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?b86170f998d4ba7d7e834894b1f02595";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>