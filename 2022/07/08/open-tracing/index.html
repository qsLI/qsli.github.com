<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="python | C++ | C plus plus | java"><title>open-tracing | KL's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body> <div id="particles-js"></div><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">open-tracing</h1><a id="logo" href="/.">KL's blog</a><p class="description">世事洞明皆学问，人情练达即文章</p></div><div id="nav-menu"><a href="/"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/recommendation/"><i class="fa fa-leaf"> 推荐</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">open-tracing</h1><div class="post-meta">Jul 8, 2022<span> | </span><span class="category"><a href="/categories/microservice/">microservice</a></span><script type="text/javascript" src="/js/busuanzi.pure.mini.js?v=0.0.0" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2022/07/08/open-tracing/" href="/2022/07/08/open-tracing/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Open-Tracing"><span class="toc-number">1.</span> <span class="toc-text">Open-Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Trace概念"><span class="toc-number">1.1.</span> <span class="toc-text">Trace概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TraceId作用"><span class="toc-number">1.1.1.</span> <span class="toc-text">TraceId作用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenZipkin"><span class="toc-number">2.</span> <span class="toc-text">OpenZipkin</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Brave"><span class="toc-number">2.1.</span> <span class="toc-text">Brave</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Trace上下文传递"><span class="toc-number">2.1.1.</span> <span class="toc-text">Trace上下文传递</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zipkin"><span class="toc-number">2.2.</span> <span class="toc-text">zipkin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#系统接入"><span class="toc-number">2.3.</span> <span class="toc-text">系统接入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-Cloud"><span class="toc-number">3.</span> <span class="toc-text">Spring-Cloud</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sleuth"><span class="toc-number">3.1.</span> <span class="toc-text">Sleuth</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题排查"><span class="toc-number">4.</span> <span class="toc-text">问题排查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="post-content"><h2 id="Open-Tracing"><a href="#Open-Tracing" class="headerlink" title="Open-Tracing"></a>Open-Tracing</h2><blockquote>
<p>现代微服务架构正在逐渐普及。面对真正高并发的生产系统，解耦成大量微服务后，以前容易实现的重点任务变得不容易实现了：用户体验优化、后台真实错误原因分析、系统内各组件的调用情况等。分布式跟踪系统（Zipkin、Dapper、HTrace、X-Trace等）可以解决这个问题，但是这些系统使用不兼容的API，难以整合到一起。</p>
<p><strong>OpenTracing提供平台无关、厂商无关的API，让开发人员可以方便地添加、更换追踪系统。</strong></p>
</blockquote>
<p>相当于是在做标准化，类似日志中的SLF4j，目前还在发展中。</p>
<h3 id="Trace概念"><a href="#Trace概念" class="headerlink" title="Trace概念"></a>Trace概念</h3><p>1、Trace(追踪):<br>在广义上，一个trace代表了一个事务或者流程在（分布式）系统中的执行过程。在OpenTracing标准中，trace是多个span组成的一个有向无环图（DAG），每一个span代表trace中被命名并计时的连续性的执行片段。</p>
<p>2、Span(跨度)：一个span代表系统中具有开始时间和执行时长的逻辑运行单元。span之间通过嵌套或者顺序排列建立逻辑因果关系。</p>
<img src="/2022/07/08/open-tracing/image-20210312022847325.png">
<img src="/2022/07/08/open-tracing/image-20210312022824793.png">
<h4 id="TraceId作用"><a href="#TraceId作用" class="headerlink" title="TraceId作用"></a>TraceId作用</h4><ul>
<li>串起来一次请求</li>
</ul>
<img src="/2022/07/08/open-tracing/image-20210312022800718.png">
<ul>
<li><p>request-id</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"RequestId"</span>: <span class="string">"4C467B38-3910-447D-87BC-AC049166F216"</span></span><br><span class="line">    /* 返回结果数据 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第三方有问题反馈时，可以拿着这个id作为凭证，就省去了很多沟通的问题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[qisheng.li@YD-app-api-01 logs]$ curl -sI <span class="string">'http://api2.yaduo.com/atourlife/duomicang/queryDuoMiCangTabOtherData?appVer=3.6.0&amp;channelId=10005&amp;platType=1&amp;token=7254035f0e3e4d05bc7af3afb54f313e&amp;deviceId=73519b32-c539-3c18-af4c-ce4523938bb9&amp;activitySource=ydaandroid&amp;activeId=&amp;inactiveId='</span></span><br><span class="line">HTTP/1.1 200</span><br><span class="line">Date: Fri, 12 Mar 2021 06:19:56 GMT</span><br><span class="line">Content-Type: application/json;charset=UTF-8</span><br><span class="line">Content-Length: 2477</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Set-Cookie: acw_tc=2760829916155299964998880ec4036c629fa0b9319095cdd9fffc150bc930;path=/;HttpOnly;Max-Age=1800</span><br><span class="line">ZIPKIN-TRACE-ID: f39f5791988ff5b2</span><br></pre></td></tr></table></figure>
<img src="/2022/07/08/open-tracing/image-20210312142240390.png">
</li>
<li><p>elk关联日志</p>
<img src="/2022/07/08/open-tracing/image-20210312022225378.png">
</li>
<li><p>幂等</p>
</li>
</ul>
<h2 id="OpenZipkin"><a href="#OpenZipkin" class="headerlink" title="OpenZipkin"></a>OpenZipkin</h2><h3 id="Brave"><a href="#Brave" class="headerlink" title="Brave"></a>Brave</h3><blockquote>
<p>Brave is a distributed tracing instrumentation library. </p>
<p>Brave’s dependency-free <a href="https://github.com/openzipkin/brave/blob/master/brave" rel="external nofollow noopener noreferrer" target="_blank">tracer library</a> works against JRE6+. </p>
</blockquote>
<p>可以简单理解为标准的实现（类比logback和log4j）</p>
<h4 id="Trace上下文传递"><a href="#Trace上下文传递" class="headerlink" title="Trace上下文传递"></a>Trace上下文传递</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> Client Tracer                                                  Server Tracer     </span><br><span class="line">┌───────────────────────┐                                       ┌───────────────────────┐</span><br><span class="line">│                       │                                       │                       │</span><br><span class="line">│   TraceContext        │          Http Request Headers         │   TraceContext        │</span><br><span class="line">│ ┌───────────────────┐ │         ┌───────────────────┐         │ ┌───────────────────┐ │</span><br><span class="line">│ │ TraceId           │ │         │ X-B3-TraceId      │         │ │ TraceId           │ │</span><br><span class="line">│ │                   │ │         │                   │         │ │                   │ │</span><br><span class="line">│ │ ParentSpanId      │ │ Inject  │ X-B3-ParentSpanId │ Extract │ │ ParentSpanId      │ │</span><br><span class="line">│ │                   ├─┼────────&gt;│                   ├─────────┼&gt;│                   │ │</span><br><span class="line">│ │ SpanId            │ │         │ X-B3-SpanId       │         │ │ SpanId            │ │</span><br><span class="line">│ │                   │ │         │                   │         │ │                   │ │</span><br><span class="line">│ │ Sampling decision │ │         │ X-B3-Sampled      │         │ │ Sampling decision │ │</span><br><span class="line">│ └───────────────────┘ │         └───────────────────┘         │ └───────────────────┘ │</span><br><span class="line">│                       │                                       │                       │</span><br><span class="line">└───────────────────────┘                                       └───────────────────────┘</span><br></pre></td></tr></table></figure>
<p>http请求</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">2021-03-12 01:29:19.624 INFO [order-center,f211feedd7b9904e,9c4b9442005296fb,<span class="literal">true</span>] --- [o-9301-exec-131] http.request.response.log                :</span><br><span class="line">ip: 192.168.6.214</span><br><span class="line">POST http://192.168.6.215:9301/point/pay/query/list?</span><br><span class="line">x-b3-spanid: 9c4b9442005296fb</span><br><span class="line">x-b3-parentspanid: 5e901c4a1fb6be73</span><br><span class="line">x-b3-sampled: 1</span><br><span class="line">x-b3-traceid: f211feedd7b9904e</span><br><span class="line">appcode: pms</span><br><span class="line">content-type: application/json;charset=UTF-8</span><br><span class="line">accept: */*</span><br><span class="line">host: 192.168.6.215:9301</span><br><span class="line">connection: Keep-Alive</span><br><span class="line">user-agent: Apache-HttpClient/4.5.6 (Java/1.8.0_171)</span><br><span class="line">accept-encoding: gzip,deflate</span><br><span class="line">atour-time-out: 1000,20000</span><br><span class="line">atour-proxyee-info: http://192.168.6.215:9301</span><br><span class="line"></span><br><span class="line">&#123;  <span class="string">"chainId"</span> : 440319,  <span class="string">"folioIdList"</span> : [ 2589101966 ]&#125;</span><br><span class="line"></span><br><span class="line">ret code 200, start time 1615483759621 --&gt; end time 1615483759624, cost: 3</span><br></pre></td></tr></table></figure>
<p>header中的<code>x-b3</code>开头的会自动传递下去</p>
<p>采样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">                                Server Tracer     </span><br><span class="line">                              ┌───────────────────────┐</span><br><span class="line"> Health check request         │                       │</span><br><span class="line">┌───────────────────┐         │   TraceContext        │</span><br><span class="line">│ GET /health       │ Extract │ ┌───────────────────┐ │</span><br><span class="line">│ X-B3-Sampled: 0   ├─────────┼&gt;│ NoOp              │ │</span><br><span class="line">└───────────────────┘         │ └───────────────────┘ │</span><br><span class="line">                              └───────────────────────┘</span><br></pre></td></tr></table></figure>
<h3 id="zipkin"><a href="#zipkin" class="headerlink" title="zipkin"></a>zipkin</h3><img src="/2022/07/08/open-tracing/architecture-1.png">
<ul>
<li><p>上报</p>
<img src="/2022/07/08/open-tracing/2f84e3a7-de34-449b-8733-e944bd103772.jpg">
<ul>
<li><p>上报方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">Tracing <span class="title">tracing</span><span class="params">(@Value(<span class="string">"$&#123;spring.application.name&#125;"</span>)</span> String serviceName, @<span class="title">Value</span><span class="params">(<span class="string">"$&#123;spring.zipkin.base-url:&#125;"</span>)</span> String zipkinServer) </span>&#123;</span><br><span class="line">  Reporter reporter = Reporter.NOOP;</span><br><span class="line">  <span class="keyword">if</span> (StringUtils.isNotBlank(zipkinServer)) &#123;</span><br><span class="line">    reporter = AsyncReporter.builder(OkHttpSender.create(zipkinServer))</span><br><span class="line">      .queuedMaxSpans(<span class="number">1000</span>) <span class="comment">// historical constraint. Note: AsyncReporter supports memory bounds</span></span><br><span class="line">      .messageTimeout(<span class="number">1</span>, TimeUnit.SECONDS)</span><br><span class="line">      .metrics(ReporterMetrics.NOOP_METRICS)</span><br><span class="line">      .build(SpanBytesEncoder.JSON_V2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span> SamplerProperties samplerProperties = <span class="keyword">new</span> SamplerProperties();</span><br><span class="line">  <span class="comment">// 默认全采样</span></span><br><span class="line">  samplerProperties.setProbability(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> Tracing.newBuilder()</span><br><span class="line">    .sampler(<span class="keyword">new</span> ProbabilityBasedSampler(samplerProperties))</span><br><span class="line">    .localServiceName(serviceName)</span><br><span class="line">    .propagationFactory(ExtraFieldPropagation.newFactory(B3Propagation.FACTORY, <span class="string">"user-name"</span>))</span><br><span class="line">    .currentTraceContext(Slf4jCurrentTraceContext.create(ThreadLocalCurrentTraceContext.newBuilder()</span><br><span class="line">                                                         .build()))</span><br><span class="line">    .spanReporter(reporter)</span><br><span class="line">    .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>- 采样
- Reporter
- eureka支持
</code></pre><ul>
<li>挂掉影响<ul>
<li>Zipkin 展示端</li>
<li><img src="/2022/07/08/open-tracing/web-screenshot.png"></li>
<li><img src="/2022/07/08/open-tracing/dependency-graph.png"></li>
<li>zipkin存储</li>
</ul>
</li>
<li>mysql<ul>
<li>玩具</li>
</ul>
</li>
<li>elastic-search<ul>
<li>调优<ul>
<li>translog</li>
<li>Refresh_interval</li>
<li>_id</li>
</ul>
</li>
<li>保留几天</li>
<li>定时删除脚本</li>
<li>elastic-search的template</li>
</ul>
</li>
</ul>
<h3 id="系统接入"><a href="#系统接入" class="headerlink" title="系统接入"></a>系统接入</h3><h2 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring-Cloud"></a>Spring-Cloud</h2><h3 id="Sleuth"><a href="#Sleuth" class="headerlink" title="Sleuth"></a>Sleuth</h3><blockquote>
<p>Sleuth configures everything you need to get started. This includes where trace data (spans) are reported to, how many traces to keep (sampling), if remote fields (baggage) are sent, and which libraries are traced.</p>
<p>Spring Cloud Sleuth integrates with the OpenZipkin Brave tracer via the bridge that is available in the <code>spring-cloud-sleuth-brave</code> module.</p>
</blockquote>
<ul>
<li><p>baggage</p>
<ul>
<li><p>Request级别的日志debug开关</p>
<p>@see <a href="http://wiki.corp.yaduo.com/index.php/Sleuth-debug-flag" rel="external nofollow noopener noreferrer" target="_blank">Sleuth-debug-flag - Atour Wiki</a></p>
</li>
</ul>
</li>
</ul>
<img src="/2022/07/08/open-tracing/image-20210312130036912.png"> <img src="/2022/07/08/open-tracing/image-20210312125542638.png">
 <img src="/2022/07/08/open-tracing/image-20210312125715781.png">
 <img src="/2022/07/08/open-tracing/image-20210312125618924.png">
 <img src="/2022/07/08/open-tracing/image-20210312125751929.png">
 <img src="/2022/07/08/open-tracing/image-20210312125846371.png">
<ul>
<li>@NewSpan</li>
<li>@SpanTag</li>
<li>@ContinueSpan</li>
</ul>
<p>相关代码位置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.cloud.sleuth.instrument.web.TraceWebServletAutoConfiguration</span></span><br><span class="line"><span class="comment">// brave.servlet.TracingFilter</span></span><br><span class="line"><span class="comment">// org.springframework.cloud.sleuth.autoconfig.TraceAutoConfiguration#sleuthPropagation</span></span><br><span class="line"><span class="comment">// org.springframework.cloud.sleuth.log.SleuthLogAutoConfiguration</span></span><br><span class="line"></span><br><span class="line">Slf4jCurrentTraceContext &lt;- CurrentTraceContext</span><br></pre></td></tr></table></figure>
<p>埋点增强</p>
<ul>
<li><p>db</p>
</li>
<li><p>线程池</p>
<ul>
<li><p>Brave:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// brave.propagation.CurrentTraceContext</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Decorates the input such that the &#123;<span class="doctag">@link</span> #get() current trace context&#125; at the time a task is</span></span><br><span class="line"><span class="comment">   * scheduled is made current when the task is executed.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ExecutorService <span class="title">executorService</span><span class="params">(ExecutorService delegate)</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">CurrentTraceContextExecutorService</span> <span class="keyword">extends</span> <span class="title">brave</span>.<span class="title">internal</span>.<span class="title">WrappingExecutorService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> ExecutorService <span class="title">delegate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> delegate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="keyword">protected</span> &lt;C&gt; <span class="function">Callable&lt;C&gt; <span class="title">wrap</span><span class="params">(Callable&lt;C&gt; task)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> CurrentTraceContext.<span class="keyword">this</span>.wrap(task);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> Runnable <span class="title">wrap</span><span class="params">(Runnable task)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> CurrentTraceContext.<span class="keyword">this</span>.wrap(task);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> CurrentTraceContextExecutorService();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Wraps the input so that it executes with the same context as now. */</span></span><br><span class="line"><span class="keyword">public</span> &lt;C&gt; <span class="function">Callable&lt;C&gt; <span class="title">wrap</span><span class="params">(Callable&lt;C&gt; task)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> TraceContext invocationContext = get();</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">CurrentTraceContextCallable</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">C</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> C <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> (Scope scope = maybeScope(invocationContext)) &#123;</span><br><span class="line">        <span class="keyword">return</span> task.call();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> CurrentTraceContextCallable();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>sleuth:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.cloud.sleuth.instrument.async.LazyTraceExecutor</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.tracing == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.tracing = <span class="keyword">this</span>.beanFactory.getBean(Tracing<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (NoSuchBeanDefinitionException e) &#123;</span><br><span class="line">      <span class="keyword">this</span>.delegate.execute(command);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.delegate.execute(<span class="keyword">new</span> TraceRunnable(<span class="keyword">this</span>.tracing, spanNamer(), command));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// org.springframework.cloud.sleuth.instrument.async.ExecutorBeanPostProcessor  代理逻辑</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>bolt</p>
</li>
<li><p>feign</p>
</li>
<li><p>rocketmq</p>
</li>
</ul>
<h2 id="问题排查"><a href="#问题排查" class="headerlink" title="问题排查"></a>问题排查</h2><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a href="http://wiki.corp.yaduo.com/index.php/Zikin-server%E8%BF%90%E7%BB%B4" rel="external nofollow noopener noreferrer" target="_blank">Zikin-server运维 - Atour Wiki</a></li>
<li><a href="https://opentracing.io/docs/overview/what-is-tracing/" rel="external nofollow noopener noreferrer" target="_blank">What is Distributed Tracing?</a></li>
<li><a href="https://blog.btstream.net/post/2019-01-14-spring-cloud-sleuth-2.0%E6%A6%82%E8%A6%81%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" rel="external nofollow noopener noreferrer" target="_blank">Spring Cloud Sleuth 2.0概要使用说明 - BTStream’s Blog</a></li>
<li><a href="https://github.com/spring-cloud/spring-cloud-sleuth" rel="external nofollow noopener noreferrer" target="_blank">GitHub - spring-cloud/spring-cloud-sleuth: Distributed tracing for spring cloud</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/268740698" rel="external nofollow noopener noreferrer" target="_blank">OpenTracing基本原理 - 知乎</a></li>
<li><a href="https://wu-sheng.gitbooks.io/opentracing-io/content/" rel="external nofollow noopener noreferrer" target="_blank">openTracing文档中文版</a></li>
<li><a href="https://github.com/openzipkin/brave" rel="external nofollow noopener noreferrer" target="_blank">GitHub - openzipkin/brave: Java distributed tracing implementation compatible with Zipkin backend services.</a></li>
<li><a href="http://wiki.corp.yaduo.com/index.php/Sleuth-debug-flag" rel="external nofollow noopener noreferrer" target="_blank">Sleuth-debug-flag - Atour Wiki</a></li>
<li><a href="https://itzone.com.vn/en/article/introducing-to-zipkin-distribution-tracing/amp/" rel="external nofollow noopener noreferrer" target="_blank">Introducing to Zipkin - Distribution Tracing - ITZone</a></li>
<li><a href="https://zipkin.io/" rel="external nofollow noopener noreferrer" target="_blank">OpenZipkin · A distributed tracing system</a></li>
<li><a href="https://github.com/openzipkin/b3-propagation" rel="external nofollow noopener noreferrer" target="_blank">GitHub - openzipkin/b3-propagation: Repository that describes and sometimes implements B3 propagation</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MjM5MDI3MjA5MQ==&amp;mid=2697266385&amp;idx=2&amp;sn=2712989b72306cb153e1fcbac216bef2&amp;chksm=8376fbe5b40172f35eb049e81fdd0f554a281458acb6ff0066e7da9ce15e52d0e67bc42ae4ac&amp;mpshare=1&amp;scene=1&amp;srcid=0403dk8RFwBQSrcJQGiZW0Pm%23rd" rel="external nofollow noopener noreferrer" target="_blank">干货 | Qunar全链路跟踪及Debug</a></li>
<li><a href="http://zipkin.kibana.corp.yaduo-l.com/app/kibana" rel="external nofollow noopener noreferrer" target="_blank">zipkin-Kibana</a></li>
<li><a href="http://elk.corp.yaduo-l.com/app/kibana#/discover?_g=(" rel="external nofollow noopener noreferrer" target="_blank">elk-Discover - Kibana</a>&amp;_a=(columns:!(_source),index:’01f5dec0-e772-11ea-9d81-e1017b1b6645’,interval:auto,query:(language:lucene,query:ee3ceac468425f6e),sort:!(‘@timestamp’,desc)))</li>
</ol>
</div><footer class="post-footer"><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者: </strong>代故</li><li class="post-copyright-link"><strong>本文链接: </strong>    <a href="/2022/07/08/open-tracing/" target="_blank">http://qsli.github.io/2022/07/08/open-tracing/index.html</a></li>  <li class="post-copyright-license"><strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 3.0 CN</a></li></ul></div></footer><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://qsli.github.io/2022/07/08/open-tracing/" data-id="cl5e3lrzn00eet3714jzzv89g" class="article-share-link">分享到</a><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" href="javascript:;" title="打赏" class="btn_donate"></a><div class="donate_txt"> &uarr;<br>此文有用? 整杯冰阔乐!<br></div></div><div id="donate_guide" class="donate_bar center hidden"><img src="http://qsli.github.io/about/praise.jpg" title="微信打赏"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    $('#donate_board').addClass('hidden');
    $('#donate_guide').removeClass('hidden');
}</script></div><div class="tags"><a href="/tags/tracing/">tracing</a></div><div class="post-nav"><a href="/2021/12/05/tomcat-startup-2/" class="next">tomcat-startup-2</a></div><div id="disqus_thread"><script>var disqus_shortname = 'blog-huytwsybye';
var disqus_identifier = '2022/07/08/open-tracing/';
var disqus_title = 'open-tracing';
var disqus_url = 'http://qsli.github.io/2022/07/08/open-tracing/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//blog-huytwsybye.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://qsli.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/base/">base</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/db/">db</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/druid/">druid</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/dubbo/">dubbo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/fe/">fe</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/feign/">feign</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/guava/">guava</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/idea/">idea</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/jdbc/">jdbc</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/jvm/">jvm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mediawiki/">mediawiki</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/microservice/">microservice</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mybatis/">mybatis</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/perf/">perf</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tomcat/">tomcat</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/xml/" style="font-size: 15px;">xml</a> <a href="/tags/jackson/" style="font-size: 15px;">jackson</a> <a href="/tags/logback/" style="font-size: 15px;">logback</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/剪贴板/" style="font-size: 15px;">剪贴板</a> <a href="/tags/mat/" style="font-size: 15px;">mat</a> <a href="/tags/guava/" style="font-size: 15px;">guava</a> <a href="/tags/编码/" style="font-size: 15px;">编码</a> <a href="/tags/cache/" style="font-size: 15px;">cache</a> <a href="/tags/cglib/" style="font-size: 15px;">cglib</a> <a href="/tags/cygwin/" style="font-size: 15px;">cygwin</a> <a href="/tags/自定义标签/" style="font-size: 15px;">自定义标签</a> <a href="/tags/crontab/" style="font-size: 15px;">crontab</a> <a href="/tags/pitfall-mysql-connector-java-8-x/" style="font-size: 15px;">pitfall mysql-connector-java 8.x</a> <a href="/tags/electron/" style="font-size: 15px;">electron</a> <a href="/tags/fabric/" style="font-size: 15px;">fabric</a> <a href="/tags/beanfactory/" style="font-size: 15px;">beanfactory</a> <a href="/tags/spring-cloud/" style="font-size: 15px;">spring-cloud</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/go学习资料/" style="font-size: 15px;">go学习资料</a> <a href="/tags/git-commit-id/" style="font-size: 15px;">git-commit-id</a> <a href="/tags/grafana/" style="font-size: 15px;">grafana</a> <a href="/tags/hexo-install/" style="font-size: 15px;">hexo install</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/lsof/" style="font-size: 15px;">lsof</a> <a href="/tags/tranfer-encoding/" style="font-size: 15px;">tranfer-encoding</a> <a href="/tags/template/" style="font-size: 15px;">template</a> <a href="/tags/jar/" style="font-size: 15px;">jar</a> <a href="/tags/exception/" style="font-size: 15px;">exception</a> <a href="/tags/Javadoc/" style="font-size: 15px;">Javadoc</a> <a href="/tags/访问权限/" style="font-size: 15px;">访问权限</a> <a href="/tags/java-connector/" style="font-size: 15px;">java-connector</a> <a href="/tags/jinfo/" style="font-size: 15px;">jinfo</a> <a href="/tags/ajax/" style="font-size: 15px;">ajax</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/markdown-here/" style="font-size: 15px;">markdown-here</a> <a href="/tags/mindmap/" style="font-size: 15px;">mindmap</a> <a href="/tags/plantuml/" style="font-size: 15px;">plantuml</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/自增主键/" style="font-size: 15px;">自增主键</a> <a href="/tags/netcat/" style="font-size: 15px;">netcat</a> <a href="/tags/pip/" style="font-size: 15px;">pip</a> <a href="/tags/uml/" style="font-size: 15px;">uml</a> <a href="/tags/postgresql/" style="font-size: 15px;">postgresql</a> <a href="/tags/python-util/" style="font-size: 15px;">python-util</a> <a href="/tags/re/" style="font-size: 15px;">re</a> <a href="/tags/shadowsocks/" style="font-size: 15px;">shadowsocks</a> <a href="/tags/limit/" style="font-size: 15px;">limit</a> <a href="/tags/spi/" style="font-size: 15px;">spi</a> <a href="/tags/spring-mvc/" style="font-size: 15px;">spring mvc</a> <a href="/tags/sqlserver-killer/" style="font-size: 15px;">sqlserver-killer</a> <a href="/tags/sudo-log/" style="font-size: 15px;">sudo-log</a> <a href="/tags/swap/" style="font-size: 15px;">swap</a> <a href="/tags/access-log/" style="font-size: 15px;">access-log</a> <a href="/tags/busy-thread/" style="font-size: 15px;">busy-thread</a> <a href="/tags/connections/" style="font-size: 15px;">connections</a> <a href="/tags/encoding/" style="font-size: 15px;">encoding</a> <a href="/tags/string-manager/" style="font-size: 15px;">string-manager</a> <a href="/tags/feign/" style="font-size: 15px;">feign</a> <a href="/tags/servlet/" style="font-size: 15px;">servlet</a> <a href="/tags/format/" style="font-size: 15px;">format</a> <a href="/tags/druid/" style="font-size: 15px;">druid</a> <a href="/tags/generic/" style="font-size: 15px;">generic</a> <a href="/tags/executor/" style="font-size: 15px;">executor</a> <a href="/tags/greys/" style="font-size: 15px;">greys</a> <a href="/tags/event-bus/" style="font-size: 15px;">event-bus</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/executeBatch/" style="font-size: 15px;">executeBatch</a> <a href="/tags/HttpURLConnection/" style="font-size: 15px;">HttpURLConnection</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/mybatis/" style="font-size: 15px;">mybatis</a> <a href="/tags/tracing/" style="font-size: 15px;">tracing</a> <a href="/tags/reference/" style="font-size: 15px;">reference</a> <a href="/tags/resource/" style="font-size: 15px;">resource</a> <a href="/tags/sudo/" style="font-size: 15px;">sudo</a> <a href="/tags/top/" style="font-size: 15px;">top</a> <a href="/tags/volatile/" style="font-size: 15px;">volatile</a> <a href="/tags/messageConverter/" style="font-size: 15px;">messageConverter</a> <a href="/tags/google-perf/" style="font-size: 15px;">google-perf</a> <a href="/tags/jdwp/" style="font-size: 15px;">jdwp</a> <a href="/tags/keepalive/" style="font-size: 15px;">keepalive</a> <a href="/tags/spring-bean/" style="font-size: 15px;">spring-bean</a> <a href="/tags/cache-prep-stmts/" style="font-size: 15px;">cache-prep-stmts</a> <a href="/tags/placeholder/" style="font-size: 15px;">placeholder</a> <a href="/tags/tcp/" style="font-size: 15px;">tcp</a> <a href="/tags/tomcat-startup/" style="font-size: 15px;">tomcat-startup</a> <a href="/tags/transaction/" style="font-size: 15px;">transaction</a> <a href="/tags/spring-validator/" style="font-size: 15px;">spring-validator</a> <a href="/tags/spring-aop/" style="font-size: 15px;">spring-aop</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/07/08/open-tracing/">open-tracing</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/05/tomcat-startup-2/">tomcat-startup-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/27/tomcat-component-lifecycle/">tomcat-component-lifecycle</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/20/tomcat-startup/">tomcat-startup</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/10/16/web-xml/">web.xml</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/10/16/hexo-ubuntu/">hexo迁移到ubuntu</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/08/git-commit-id/">git-commit-id执行耗时过长</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/29/keepalive/">keepalive</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/23/spring-tx/">spring-transaction</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/23/mybatis-detail-03/">mybatis源码解析（三）—— Spring集成</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//blog-huytwsybye.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://iip.whu.edu.cn/" title="武汉大学智能信息处理实验室" target="_blank" rel="external nofollow noopener noreferrer">武汉大学智能信息处理实验室</a><ul></ul><a href="http://calvin1978.blogcn.com/" title="江南白衣" target="_blank" rel="external nofollow noopener noreferrer">江南白衣</a><ul></ul><a href="https://chenyuzuoo.github.io/" title="Chenyu's Script" target="_blank" rel="external nofollow noopener noreferrer">Chenyu's Script</a><ul></ul><a href="https://zhangpengdeshu.github.io/" title="前端小胖儿" target="_blank" rel="external nofollow noopener noreferrer">前端小胖儿</a><ul></ul><a href="http://huzongzhe.cn/" title="胡大腿" target="_blank" rel="external nofollow noopener noreferrer">胡大腿</a></div><div class="widget"><div class="widget-title"><i class="fa fa-eye"> 本站访问量</i></div><div><script type="text/javascript" src="/js/busuanzi.pure.mini.js?v=0.0.0" async="async"></script><p> 访问量:<span id="busuanzi_value_site_pv"> </span></p><p> 访客数:<span id="busuanzi_value_site_uv"></span></p></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer"><p><a href="/." rel="nofollow">KL's blog </a><span>© 2015 - 2022.</span></p><p> Powered by<a rel="external nofollow noopener noreferrer" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="external nofollow noopener noreferrer" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="external nofollow noopener noreferrer" target="_blank" href="https://github.com/pagecho"> Cho.</a></p></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="/js/kity.min.js?v=0.0.0" sync></script><script type="text/javascript" src="/js/kityminder.core.js?v=0.0.0" sync></script><script type="text/javascript" src="/js/mindmap.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?b86170f998d4ba7d7e834894b1f02595";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>